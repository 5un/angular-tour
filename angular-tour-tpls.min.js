!function(){"use strict";angular.module("angular-tour",["angular-tour.tpls","angular-tour.tour"]),angular.module("angular-tour.tpls",["tour/tour.tpl.html"]),angular.module("tour/tour.tpl.html",[]).run(["$templateCache",function(a){a.put("tour/tour.tpl.html",'<div class="tour-tip">\n    <span class="tour-arrow tt-{{ placement }}"></span>\n    <div class="tour-content-wrapper">\n        <p ng-bind="content"></p>\n        <a ng-click="nextAction()" ng-bind="nextLabel" class="small button tour-next-tip"></a>\n        <a ng-click="closeAction()" class="tour-close-tip">Ã—</a>\n    </div>\n</div>')}]),angular.module("angular-tour.tour",[]).constant("tourConfig",{placement:"top",animation:!0,nextLabel:"Next",scrollSpeed:200,offset:28,cookies:!0,cookieName:"ngTour",postTourCallback:function(){},postStepCallback:function(){}}).provider("$cookieStore",function(){var a=this;a.defaultOptions={},a.setDefaultOptions=function(b){a.defaultOptions=b},a.$get=function(){return{get:function(a){var b=$.cookie(a);return b?angular.fromJson(b):void 0},put:function(b,c,d){d=$.extend({},a.defaultOptions,d),$.cookie(b,angular.toJson(c),d)},remove:function(b,c){c=$.extend({},a.defaultOptions,c),$.removeCookie(b,c)}}}}).config(["$cookieStoreProvider",function(a){a.setDefaultOptions({path:"/",expires:3650})}]).controller("TourController",["$scope","OrderedList","tourConfig","$cookieStore",function(a,b,c,d){var e=this,f=-1,g=null,h=e.steps=b,i=function(a){function b(){h.indexOf(a)===g&&e.select(a)}function f(){h.first()===a?e.select(a):a.tt_open=!1}var g=d.get(c.cookieName),i=d.get(c.cookieName+"_closed");i||(g&&c.cookies?b():f())};e.selectAtIndex=function(a){h.get(a)&&e.select(h.get(a))},e.getCurrentStep=function(){return g},e.select=function(a){function b(){g&&(g.tt_open=!1),g=a,f=c,a.tt_open=!0}var c=h.indexOf(a);a&&b()},e.addStep=function(a){angular.isNumber(a.index)&&!isNaN(a.index)?h.set(a.index,a):h.push(a)},e.endTour=function(a){h.forEach(function(a){a.tt_open=!1}),!a&&c.cookies&&d.put(c.cookieName+"_closed",!0),c.postTourCallback(f)},e.startTour=function(){d.get(c.cookieName+"_completed")||(c.cookies&&d.put(c.cookieName+"_closed",!1),h.forEach(function(a){i(a)}))},a.openTour=function(){d.get(c.cookieName+"_completed")&&c.cookies&&(d.put(c.cookieName+"_completed",!1),e.save(h.indexOf(h.first()))),e.startTour()},a.closeTour=function(){e.endTour()},e.save=function(a){d.put(c.cookieName,a)},e.next=function(){var a=f+1;c.cookies&&e.save(f+1),a+1>h.getCount()&&(e.endTour(),d.put(c.cookieName+"_completed",!0)),c.postStepCallback(a),e.select(h.get(a))}}]).directive("tour",function(){return{controller:"TourController",scope:!0,restrict:"EA",link:function(){}}}).directive("tourReopen",function(){return{require:["^parentDirective","^ngModel"],scope:!0,restrict:"EA",link:function(){}}}).directive("tourTip",["$window","$compile","$interpolate","$timeout","scrollTo","tourConfig",function(a,b,c,d,e,f){var g=c.startSymbol(),h=c.endSymbol(),i='<div tour-popup next-label="'+g+"tt_next_label"+h+'" content="'+g+"tt_content"+h+'" placement="'+g+"tt_placement"+h+'" next-action="tt_next_action()" close-action="tt_close_action()" is-open="'+g+"tt_open"+h+'" ></div>';return{require:"^tour",restrict:"EA",scope:{},link:function(a,c,g,h){function j(){var b,d,f,g,h,i,j;if(a.tt_content){switch(a.animation?l.fadeIn():l.css({display:"block"}),c.after(l),j=c.children().eq(0).length>0?c.children().eq(0):c,b=j.position()||c.position(),d=l.width(),f=l.height(),i=j.width(),h=j.height(),a.tt_placement){case"right":e(j),g={top:b.top,left:b.left+i+a.tt_offset};break;case"bottom":e(j),g={top:b.top+h+a.tt_offset,left:b.left};break;case"left":e(j),g={top:b.top,left:b.left-d-a.tt_offset};break;default:e(j,200),g={top:b.top-f-a.tt_offset,left:b.left}}g.top+="px",g.left+="px",l.css(g)}}function k(){l.detach()}g.$observe("tourTip",function(b){a.tt_content=b}),g.$observe("placement",function(b){a.tt_placement=b||f.placement}),g.$observe("nextLabel",function(b){a.tt_next_label=b||f.nextLabel}),g.$observe("offset",function(b){a.tt_offset=b||f.offset}),a.animation=g.offset||f.animation,a.tt_open=!1,a.tt_next_action=h.next,a.tt_close_action=h.endTour,a.index=parseInt(g.step,10);var l=b(i)(a);h.addStep(a),d(function(){h.startTour()},100),a.$watch("tt_open",function(b){b?(h.select(a),j()):k()})}}}]).directive("tourPopup",function(){return{replace:!0,templateUrl:"tour/tour.tpl.html",scope:{content:"@",nextLabel:"@",placement:"@",nextAction:"&",closeAction:"&",isOpen:"@"},restrict:"EA",link:function(){}}}).factory("OrderedList",function(){var a=this;return a.map={},a._array=[],{set:function(b,c){if(angular.isNumber(b))if(b in a.map)a.map[b]=c;else{if(b<a._array.length){var d=b-1>0?b-1:0;a._array.splice(d,0,b)}else a._array.push(b);a.map[b]=c,a._array.sort()}},indexOf:function(b){for(var c in a.map)if(a.map.hasOwnProperty(c)&&a.map[c]===b)return Number(c)},push:function(b){var c=a._array[a._array.length-1]+1||0;a._array.push(c),a.map[c]=b,a._array.sort()},remove:function(b){var c=a._array.indexOf(b);if(-1===c)throw new Error("key does not exist");a._array.splice(c,1),delete a.map[b]},get:function(b){return a.map[b]},getCount:function(){return a._array.length},forEach:function(b){for(var c,d,e=0;e<a._array.length;e++)c=a._array[e],d=a.map[c],b(d,c)},first:function(){var b,c;return b=a._array[0],c=a.map[b]}}}).factory("scrollTo",function(){return function(a,b,c){a?(b=b||100,c=c||500,$("html,body").stop().animate({scrollTop:a.offset().top-b},c)):$("html,body").stop().animate({scrollTop:0},c)}})}(window,document);